% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment_analysis.R
\name{enrichment_analysis}
\alias{enrichment_analysis}
\alias{enrichment_analysis,ribosomeObj-method}
\title{Enrichment Analysis for Ribosome Profiling Data}
\usage{
enrichment_analysis(
  object,
  total = NULL,
  seRP = NULL,
  mode = c("codon", "nt"),
  rep_name = NULL,
  compare_group_name = NULL,
  ...
)

\S4method{enrichment_analysis}{ribosomeObj}(
  object = NULL,
  total = NULL,
  seRP = NULL,
  mode = c("codon", "nt"),
  rep_name = NULL,
  compare_group_name = NULL,
  ...
)
}
\arguments{
\item{object}{An object of class \code{ribosomeObj} which contains normalized data and gene annotation.}

\item{total}{A character vector specifying the sample names for total ribosome.}

\item{seRP}{A character vector specifying the sample names for seRP, corresponding to `total`.}

\item{mode}{A character string specifying the analysis mode. Possible values are:
\itemize{
  \item \code{"codon"}: Perform analysis at the codon level.
  \item \code{"nt"}: Perform analysis at the nucleotide level.
}
Default is \code{"codon"}.}

\item{rep_name}{A character vector specifying replicate names for each sample.}

\item{compare_group_name}{A character vector specifying the group names for comparison.}

\item{...}{Additional arguments (not currently used).}
}
\value{
A modified \code{ribosomeObj} object with the enrichment results added to
the \code{enriched.data} slot.
}
\description{
This function performs enrichment analysis on ribosome profiling data contained in
a \code{ribosomeObj} object. The analysis compares total ribosome counts with
seRP (site-specific ribosome profiling) counts across various metrics and aggregates
the results based on codon or nucleotide positions.
}
\details{
This function performs a sliding window analysis of ribosome profiling data, where codon
occupancy or nucleotide occupancy is calculated based on combined seRP and total ribosome counts.
The results are summarized in terms of the ratio \code{seRP / total}.
The output is stored in the \code{enriched.data} slot of the \code{ribosomeObj} object.

The function processes the data by:
\enumerate{
  \item Merging normalized data with gene annotations by transcript ID.
  \item Converting transcript positions based on the selected mode (codon or nucleotide).
  \item Grouping the data by \code{sample}, \code{gene_name}, \code{trans_id}, \code{type}, and position.
  \item Calculating the seRP/total ratio for each group.
  \item Aggregating the results to generate mean/seRP ratios by gene and position.
}

The final result is added to the \code{enriched.data} slot of the \code{ribosomeObj} object,
and the unit attribute (codon or nucleotide) is attached to the results.
}
\examples{
# Assuming riboObj is a ribosomeObj object with normalized data and annotations:
\dontrun{
riboObj <- enrichment_analysis(
  object = riboObj,
  total = c("sample_total_1", "sample_total_2"),
  seRP = c("sample_seRP_1", "sample_seRP_2"),
  mode = "codon",
  rep_name = c("replicate_1", "replicate_2"),
  compare_group_name = c("groupA", "groupB")
)}

}
